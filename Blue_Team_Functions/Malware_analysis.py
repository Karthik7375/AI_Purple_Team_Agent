import os
from sys import platform

import volatility3
import subprocess


from volatility3.framework import constants,exceptions,interfaces,renderers
import volatility3.plugins
import volatility3.plugins.windows,volatility3.plugins.linux,volatility3.plugins.mac

def malware_analysis(file):
    config_path = "volatility3.cfg"
    registry = volatility3.Registry()
    registry.register_global_options(config_path,constants.PROFILE_VOLATILITY)

    context = interfaces.context.Context()

    osscan = volatility3.plugins.windows
    if platform.system() == "Windows":
        osscan = volatility3.plugins.windows
    elif platform.system() == "Linux":
        osscan = volatility3.plugins.linux
    elif platform.system() == "Mac":
        osscan = volatility3.plugins.mac


    processes = {}

    scanned_results = osscan.pslist.PsList(context)

    potential_malware= osscan.malfind.MalFind(context)
    for target in scanned_results.targets:
        processes[target] = 1





